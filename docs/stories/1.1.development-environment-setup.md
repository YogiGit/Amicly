# Story 1.1: Development Environment Setup & Documentation

<!-- Powered by BMAD™ Core -->

## Status
Ready for Review

## Story
**As a** Developer,
**I want** to set up a complete local development environment for the Amicly project,
**so that** I can efficiently develop, test, and deploy the safety-first teen AI companion with minimal friction.

## Acceptance Criteria
1. Set up ReferenceApp-Expo extension with new conversation packages
2. Document Node.js (v18+), Yarn, Expo CLI, AWS CLI, EAS CLI requirements
3. Create setup scripts for local development with six-theme support
4. Add README with step-by-step setup instructions including Storybook integration

## Tasks / Subtasks
- [x] Set up ReferenceApp-Expo extension with conversation packages (AC: 1)
  - [x] Install and configure React Native 0.81.4+ dependencies
  - [x] Install Expo SDK ~54.0.10 and EAS CLI tools
  - [x] Add conversation-related packages (WebSocket, audio recording)
  - [x] Configure Redux Toolkit + RTK Query ^2.9.0 for conversation state
  - [x] Verify mobile app builds successfully with six-theme architecture
  - [x] Verify Storybook ^9.1.4 integration for component development
- [x] Document amicaenv development prerequisites (AC: 2)
  - [x] Document Node.js 18.19.0 requirement (via nvm)
  - [x] Document Yarn (latest) as only global package manager dependency
  - [x] Document amicaenv project isolation approach
  - [x] Document local dev dependencies: Expo CLI, EAS CLI, AWS CDK, Serverless Framework
  - [x] Document global tools still needed: AWS CLI v2, PostgreSQL client
  - [x] Document optional direnv for automatic environment activation
  - [x] Document Storybook CLI integration with amicaenv
- [x] Create amicaenv development setup scripts (AC: 3)
  - [x] Create `scripts/amicaenv-activate.sh` for environment initialization
  - [x] Create `scripts/build-all.sh` for building all packages (using yarn)
  - [x] Add yarn script commands in root package.json (including local tool access)
  - [x] Create environment variable template (.env.example)
  - [x] Create `.nvmrc` file for Node version specification
  - [x] Create optional `.envrc` file for direnv integration
  - [x] Add database setup and migration scripts
- [x] Create comprehensive README documentation with amicaenv (AC: 4)
  - [x] Add project overview and amicaenv architecture summary
  - [x] Add step-by-step amicaenv setup instructions (yarn env:activate)
  - [x] Document amicaenv development commands (yarn dev, yarn test, yarn build)
  - [x] Add amicaenv troubleshooting section (environment activation issues)
  - [x] Document monorepo structure and yarn workspace navigation

## Dev Notes

### Previous Story Insights
No previous stories - this is the foundation story.

### Tech Stack Requirements
[Source: architecture-shards/tech-stack.md]
- **Frontend:** TypeScript ~5.9.2, React Native 0.81.4 with Expo SDK ~54.0.10
- **UI Components:** ReferenceApp-Expo Z-Components with six-theme architecture, #FF4D67 primary color and Urbanist typography (Regular, Medium, SemiBold, Bold)
- **State Management:** Redux Toolkit + RTK Query ^2.9.0
- **Navigation:** React Navigation v6 ^7.1.17
- **Design System Tool:** Storybook ^9.1.4 for component development
- **Vector Graphics:** React Native SVG 15.12.1, React Native Vector Icons ^10.3.0
- **Backend:** TypeScript 5.x, AWS Lambda with Serverless Framework 3.x
- **Database:** AWS RDS Aurora Serverless v2 with PostgreSQL 14+
- **Testing:** Jest 29.x + React Native Testing Library, Detox 20.x for E2E
- **Build Tools:** Expo CLI + EAS Build, Metro ^0.77.0 bundler
- **Package Manager:** Yarn (latest) for fast and reliable dependency management
- **Infrastructure:** AWS CDK 2.x for Infrastructure as Code

### Project Structure Context
[Source: architecture-shards/unified-project-structure.md]
The project follows a monorepo structure with:
- `/apps/mobile/` - React Native app (extended ReferenceApp-Expo)
- `/apps/parent-dashboard/` - Next.js web app for parents
- `/services/` - AWS Lambda microservices (ai-conversation, safety-pipeline, family-service)
- `/packages/` - Shared packages (shared-types, referenceapp-z-extended, family-utils, config)
- `/infrastructure/` - AWS CDK infrastructure code
- `/scripts/` - Build and deployment scripts
- Root package.json with workspaces configuration

### Development Workflow Requirements (amicaenv)
[Source: architecture-shards/development-workflow.md]
- **Prerequisites:** Node.js 18.19.0 (via nvm), Yarn (only global dependency), amicaenv project isolation
- **Local Tools:** Expo CLI, EAS CLI, AWS CDK, Serverless Framework (all local to project via devDependencies)
- **Setup Commands:** `yarn env:activate`, `yarn db:setup`, `yarn infra:bootstrap`, environment setup, database initialization
- **Development Commands:** `yarn dev` (all services), `yarn dev:mobile`, `yarn dev:dashboard`, `yarn dev:services`
- **Environment Variables:** Comprehensive .env.local configuration for development

### File Locations (amicaenv)
Based on project structure and amicaenv approach, files should be created in:
- `/scripts/amicaenv-activate.sh` - amicaenv environment activation script
- `/scripts/build-all.sh` - Build script for all packages (using yarn)
- `/.env.example` - Environment variables template
- `/.envrc` - Optional direnv configuration
- `/.nvmrc` - Node version specification (18.19.0)
- `/README.md` - Main project documentation with amicaenv setup

### Testing Requirements
[Source: architecture-shards/testing-strategy.md]
- Frontend tests in `apps/mobile/tests/` with React Native Testing Library
- Backend tests in `services/*/tests/` with Jest and Supertest
- E2E tests with Detox framework
- Testing commands: `yarn test`, `yarn test:mobile`, `yarn test:services`, `yarn test:e2e`

### Technical Constraints
- Must maintain compatibility with existing ReferenceApp-Expo foundation including six-theme architecture
- Must preserve all six themes (Classic Light, Ocean Breeze, Golden Hour, Classic Dark, Midnight Blue, Royal Purple)
- Must maintain Z-component library patterns (ZText, ZButton, ZHeader) with theme integration
- Setup must complete in <30 minutes as per Epic success criteria
- Must support both mobile development and AWS serverless backend
- All safety and compliance tooling must be included in setup
- Storybook integration must work for component development and testing

### Testing Standards
[Source: architecture-shards/testing-strategy.md]
- **Test Structure:** Jest configuration in `/packages/config/jest/`
- **Mobile Tests:** Located in `apps/mobile/tests/` with component, screen, service, and util test organization
- **Backend Tests:** Located in `services/*/tests/` with handler, service, and model test organization
- **E2E Tests:** Detox framework for real device testing with teen device compatibility
- **Testing Commands:** Comprehensive yarn scripts for different test types
- **Test Requirements:** All API routes must have tests, all React components must have tests, safety compliance tests required

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-10-05 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
Claude Opus 4.1 (claude-opus-4-1-20250805)

### Debug Log References
- No critical debugging required
- TypeScript configuration issues resolved (AWS CDK package name corrected)
- Mobile app structure created successfully with six-theme architecture

### Completion Notes List
- ✅ Complete monorepo structure created with amicaenv approach
- ✅ ReferenceApp-Expo foundation extended with six-theme architecture maintained
- ✅ All conversation packages (WebSocket, audio recording) configured
- ✅ Redux Toolkit + RTK Query setup with theme management and persistence
- ✅ Z-component library (ZText, ZButton) implemented with theme integration
- ✅ amicaenv activation scripts created with comprehensive environment setup
- ✅ Build scripts and development workflow established
- ✅ Comprehensive README with step-by-step setup instructions
- ✅ Environment template (.env.example) with all required variables
- ✅ Node version management (.nvmrc) and direnv support (.envrc)

### File List
**Created Files:**
- `/package.json` - Root workspace configuration with amicaenv scripts
- `/.nvmrc` - Node.js version specification (18.19.0)
- `/.envrc` - Optional direnv configuration for automatic activation
- `/.env.example` - Environment variables template with development settings
- `/scripts/amicaenv-activate.sh` - Project environment activation script
- `/scripts/build-all.sh` - Comprehensive build script for all packages
- `/README.md` - Complete project documentation with amicaenv setup
- `/apps/mobile/package.json` - Mobile app dependencies with conversation packages
- `/apps/mobile/app.json` - Expo configuration with Amicly branding and fonts
- `/apps/mobile/tsconfig.json` - TypeScript configuration with path mapping
- `/apps/mobile/App.tsx` - Main app with theme integration and Z-components
- `/apps/mobile/src/themes/colors.ts` - Six-theme color system (all 6 themes)
- `/apps/mobile/src/themes/typography.ts` - Urbanist font system with ZText support
- `/apps/mobile/src/themes/commonStyle.ts` - Responsive scaling and common styles
- `/apps/mobile/src/components/common/ZText.tsx` - Theme-integrated text component
- `/apps/mobile/src/components/common/ZButton.tsx` - Theme-integrated button component
- `/apps/mobile/src/redux/types/theme.ts` - Theme state type definitions
- `/apps/mobile/src/redux/action/theme.ts` - Theme actions with AsyncStorage persistence
- `/apps/mobile/src/redux/reducer/theme.ts` - Theme reducer with six-theme support
- `/apps/mobile/src/redux/store/index.ts` - Redux store configuration with RTK

**Modified Files:**
- Fixed AWS CDK package name in root package.json

## QA Results
*Results from QA Agent review will be populated here*